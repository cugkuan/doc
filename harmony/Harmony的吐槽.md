
Harmony App 去年已经成功上架，开发完绝大部分功能，今年更多的是修修补补，完善功能和跟谁官方版本升级。但是这个过程，仍然是吐槽连连。

# 版本引发问题

CanvasRenderingContext2D 中关于 drawImage 9个参数时

```ts
drawImage(image,sx,sy,sw,sh,dx,dy,dw,dh)
```

其中，sx,sy,sw,sh 在api 18 前 单位是 px ,之后是 vp。

卧槽，APP 后大量使用了该方法，升级到19 后，APP使用都成问题，很多组件显示异常。够忙活的。实在是不理解  华为那帮人是怎么想的，对已经发布的方法变更至少让输出结果可预期，现在是参数表达的意义变化，预期结果变化。

最简单的办法是，把该方法标注为过时方法，再新增一个方法，方便别人迁移，而不是这么处理，升完级，不看文档，都不知道是该方法出现变更！！！！！！


- 首先这个变更，就不是正常的变更，破坏已有代码的健壮性，属于破坏性变更，而该方法使用又很频繁。
- 升级api之后，出现问题，如果不是去查看文档，根本不知道是哪儿出现问题。
- 过于逆天，在api19 的手机上，不适配，也出现问题，都不知道怎么改了，卧槽


# 关于Hvigor 能力不足问题

Android 平台，Gradle 的 提供了丰富的自构建能力，可以根据自己的业务开发各种丰富的插件。而 在 Kmp/cmp 其KCP 和 KSP 也提供修改或者新增代码的能力，但是 Hvigor 确没有这个能力。

- CS 是运行在Android 平台是组件化通信框架，可以通过注解自动注册服务，但是在Harmony平台，需要手动注册，容易出错。
- Bridge 是运行在KMP/KSP 的组件化通信框架，同样使用了 Kcp 和 Ksp 技术，但是在 harmony 平台上不可以。


# APP编译版本 大于 设备版本版本时候，竟然无法安装

卧槽！！！！！，看了半天 ， compatibleSdkVersion 版本 和 targetSdkVersion 版本 竟然和我们理解的不一样，Harmony 同Android 那样有个最小版本

# RichEditor 的 onWillChange 回调参数都变化了  卧槽


# HarmonyNext 最近的改观

总体来说，Harmony Next 现在越发成熟。

首先，开放了很多能力，比如，支付，分享，文件预览，账号服务等，这些能力很容易的集成到自己的应用中，省去了很多的开发资源消耗；这一点比Android好太多。




- 可以自定义渲染节点了
- 自定义绘制
- Modifier 属性扩展


## 先天性的设计不足，后面弥补，加大开发成本

作为声明式 UI范式，状态管理是核心的核心，但是，Harmony 搞出最初 V1 版本后，发现不满足开发需求，又整出了 V2。然后，状态又分为组内状态，父子单项同步，双向同步，嵌套属性变化，页面级UI状态，应用全局UI状态，持久化存储状态.....


这种设计过于啰嗦，学习成本也高，进行UI拆分和模块设计时候，过于繁琐。相比 Compose ，则简洁太多了。就是一个State 包裹可观察对象。


# 从架构的变迁的角度看

Android  经历了 混乱的 MVC-> MVP ->MVVM(官方推荐)。UI 体系，从 xml  -> 纯代码构建 ->  Compose 转换。

整体架构，从单一的项目 -> 组件化 ->  插件化


