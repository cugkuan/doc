| 计划时间|阶段任务|备注
|:-- |  :-- | :-- |
| 7/20 ~ 7/31  | 完成技术的调研和选型 |  1. 决定技术路线（路由vs组件总线）;<br>2.结合项目的实际，思考如何设计出轻量级的组件通信框架；<br>3.构建出总体的设计框架  |
| 8/1 ~ 8/14| 完成组件通信的代码编写 | |
| 8/15 ~ 9.10 | 项目改造，使用新组件 | 1.需要清理过时失效代码；<br>2.重写部分代码以适应新的框架;<br>3.改写部分代码，重新划代码归属
| 9.11~ 9.30 | 测试 |   |

****
tapd  任务拆解

|任务名称|工时 | 时间段 | 状态
|:--| :--| :-- | :--|
| 现有组件通信问题分析和问题定位  | 2     |  7/19~7/20  | 完成|
| 组件化通信技术调研和技术选型  |  5  | 7/21~7/726  | 完成 |
| 基于CS(ComponentService 组件即服务)支持渐进式改造的组件通信框架，初版架构设计和代码编写 | 10 |7/27 ~ 8/7 |完成|
| 自动化组件注册插件（在预编译阶段，通过ASM技术生成组件注册代码）| 5| 8/8 ~8/13|完成|
| app-bs模块对外接口统一个组件改造 | 1.5 | 10/8 ~ 10/9 | 规划 |
| app_containner 模块对外接口统一和组件改造 | 1.5 | 10/9 ~ 10/10 | 规划 |
| app_im 模块对外接口的统一和组件化改造 | 1.5 | 10/11 ~ 10/12|规划|
| app_login 模块对外接口统一个组件化改造| 1.5 | 10/12 ~ 10/13| 规划|
| app 剩余模块的组件化改造| 2 | 10/14 ~ 10/15| 规划|
| 组件化改造完成后相关功能测试和性能测试并为业务测试人员提供业务测试说明 | 3 | 10/16 ~ 10/19| 规划|

# 概述

 Arouter 和美团的 WMRouter 本质上都差不多。Arouter 的Provider 概念对应着 WMRouter 的Service概念。

Arouter 的Provider 使用 Map 将其创建的对象放入其中。整个过程只创建了一次。



# 设计前的思考

 -  对于 Actvity的跳转，和跳转的结果返回，官方 给出了新的方式， ActivityResultLauncher


-  对于 异步任务，CC 给出了线程池处理，个人觉得这个设计是很失败的。业务的复杂程度，CC是不能完全满足

- WMRouter 的 Request 概念是很不错的，把一次路由行为抽象为一次 Request,CC 差不多也是这种思路。

-  准备使用 koltin 进行开发，Koltin 的高阶函数的概念还是很不错的。


 - 对于Arouter 和 WMRouter 的 Provider 概念和 Service 概念 不赞同，为什么不能统一


-  client-server 的思想 是不错的。

- CC 设计失败在于想的太多了，比如弄个异步任务；

 ## 回到 client-server


client-server 的代价是昂贵的，在设计的时候，尽量简化。

-  用户发出一条 请求
-  用户的请求有对应的 service 处理
-  service  的处理结果 返回 给用户


 javaWeb 的servlet 的概念，单 servlet 概念，多线程



其实组件之间的通信 是一种被动的。


A 需要 B 中的部分数据，或者 A 需要启动B 中的页面，那么 B 需要向外暴露东西，或者 A 与 B 有一个约定，A通过什么方式去和 B 沟通。


# 设计目标

 -  cs 架构，cs 的意思是 ComponentService 的意思，组件向外提供的服务。

-   使用组件的服务，类似于 http 协议，通过 Uri 去找到组件服务；每一次找的行为抽象为 一次 Request.
-  找到服务后，可以直接拿取结果，不使用回调的设计。

-  为了简化设计和应对多种场景，service 和 reques 本身不处理任何线程切换。

















